## 1 引论



### 1. 什么是操作系统？

可以这么说，操作系统是一种运行在内核态的软件。

它是应用程序和硬件之间的媒介，向应用程序提供硬件的抽象，以及管理硬件资源。

![操作系统是什么](https://gitee.com/ljcdzh/my_pic/raw/master/img/202111251002368.webp)



### 2. 操作系统主要有哪些功能？

操作系统最主要的功能：

- 处理器（CPU）管理：CPU的管理和分配，主要指的是进程管理
- 内存管理: 内存的分配和管理，主要利用了虚拟内存的方式。
- 外存管理：外存（磁盘等）的分配和管理，将外存以文件的形式提供出去。
- I/O管理： 对输入/输出设备的统一管理

除此之外，还保证自身正常运行的健壮性管理，防止非法操作和入侵过的安全性管理。

![操作系统主要功能](https://gitee.com/ljcdzh/my_pic/raw/master/img/202111251006282.webp)

## 2 操作系统结构

### 1. 什么是内核？

可以这么说，内核是一个计算机程序，可以控制操作系统中所有的内容。

### 2. 什么是用户态和内核态？

内核具有很高的权限，可以访问操作系统中所有的内容。所以出于权限控制的考虑，就把内存分为两个区域：

- 一是用户空间，应用程序调用
- 二是核心空间，核心程序调用

在用户空间的代码只能调用局部的内存空间，而在核心空间的代码可以调用全部的内存空间。所以当程序调用用户空间时，则说在用户态下执行，而当程序调用核心空间是，则说程序在核心态下执行。



### 3. 用户态和内核态是如何切换的？

![用户态&内核态切换](https://gitee.com/ljcdzh/my_pic/raw/master/img/202111251026008.webp)

主要是通过系统调用实现切换的。

由于用户程序执行在用户态，核心程序执行在核心态。当用户程序使用系统调用时，会产生一个中断，发生中断之后，CPU会中断当前执行的用户程序，并转交给中断处理程序处理，也就是执行内核程序，内核处理完成后，主动触发中断，并把CPU执行权限交回给应用程序，回到用户态继续工作。



## 3 进程和线程

### 1. 并行和并发有什么区别？

![并发和并行](https://gitee.com/ljcdzh/my_pic/raw/master/img/202111251037530.webp)

并发就是一段时间内多个任务执行，但是同一时刻，只能运行一个任务。在单核处理器中实现并发，其实就是利用时间片轮转实现的。比如有A和B两个进程，A运行一个时间片后转给B运行，B运行完一个时间片后转回给A，由于A与B切换速度足够快，在宏观上看起来就是一段时间内可以运行多个程序。

并行就是同一时刻中多个任务执行。只能由多核处理器实现，微观上也是同一时刻多个程序执行，属于物理上的多进程。



### 2. 什么是进程上下文切换？

![进程上下文切换-来源参考[3]](https://gitee.com/ljcdzh/my_pic/raw/master/img/202111251431282.webp)

进程上下文切换就是将CPU资源从一个进程分配给另一个进程的机制。在切换过程中，操作系统会先保存当前进程的状态（比如内存空间的指针、已执行的指令等等），然后加载另一个进程的状态，最后执行另一个进程。



### 3. 进程有哪些状态？

![进程5种状态](https://gitee.com/ljcdzh/my_pic/raw/master/img/202111251641302.webp)

当一个进程开始运行是，可能会经历运行态、就绪态、阻塞态，其中：

- 运行态（`Running`）：进程正在占用CPU
- 就绪态（`Ready`）： 因为其他进程处于运行态而暂时停止运行
- 阻塞态（`Blocked`）: 该进程正在等待某一件事情发生而暂时停止运行，这时尽管拥有CPU控制全，也无法运行

还有两个基本状态创建态、结束态，其中：

- 创建态（New）：进程正在创建。
- 结束态（Exit）：进程正在从系统中消失。

### 4. 什么是僵尸进程？

僵尸进程是已完成且处于终止状态，但是存在于进程表中的进程。

僵尸进程一般发生在有父子进程中，一个子进程的进程描述符在子进程退出是不会释放，只有当父进程通过wait()或waitpid()获取了子进程信息后才会释放。如果子进程退出，而父进程没有调用wait（）或waitpid()，那么子进程的进程描述符依旧保存在系统中。



### 5. 什么是孤儿进程？

父进程退出，但是子进程还在运行，那么这些子进程将成为孤儿进程。孤儿进程将被init进程（也就是进程ID为1的进程）所收养，并由init进程对它们完成状态收集工作。因为孤儿进程会被init进程收养，所以孤儿进程不会对系统造成危害。



### 6. 进程有哪些调度算法？

进程调度就是确定某一个时刻CPU运行哪个进程，常见的进程调度算法有：

![进程调度算法](https://gitee.com/ljcdzh/my_pic/raw/master/img/202111252034402.webp)

####  先来先服务

![先来先服务](https://gitee.com/ljcdzh/my_pic/raw/master/img/202111252035594.webp)

非抢占式的调度算法，按照请求的顺序进行调度。有利于长作业，但不利于短作业，因为短作业必须一直等待前面的长作业执行完毕才能执行，而长作业又需要执行很长时间，造成了短作业等待时间过长。另外，对I/O密集型进程也不利，因为这种进程每次进行I/O操作之后又得重新排队。

#### 短作业优先

![短作业优先](https://gitee.com/ljcdzh/my_pic/raw/master/img/202111252048626.webp)

非抢占式的调度算法，按估计运行时间最短的顺序进行调度。长作业有可能一直处于等待短作业执行完毕的状态。因为如果一直有短作业到来，那么长作业永远得不到调度。

#### 优先级调度

![优先级调度](https://gitee.com/ljcdzh/my_pic/raw/master/img/202111252052552.webp)

为每个进程分配一个优先级，按优先级进行调度。为了防止低优先级的进程永远等不到调度，可以随时间的推移增加等待进程的优先级。



#### 时间片轮转

![时间片轮转](https://gitee.com/ljcdzh/my_pic/raw/master/img/202111252055697.webp)

将所有就绪进程按先来先服务的原则排成一个队列，每次调度时，把CPU分配给队首进程，该进程执行完一个时间片后，由计时器发出时钟中断，调度程序便停止该进程的执行，并将它送往就绪队列的队尾，同时继续把CPU分配给队首的进程。

时间片轮转算法的效率和时间片的大小有很大关系：因为进程切换都要保存进程信息并载入新进程的信息，如果时间片太小，会导致进程切换频繁，在进程切换上就会花太多时间。而如果时间片太大，那么实时性就不能得到保证。

#### 最短剩余时间优先

最短作业优先的抢占式版本，按剩余运行时间的顺序进行调度。当一个新的作业到达时，其整个运行时间与当前进程的剩余时间做比较。如果新的进程需要的时间更少，则挂起当前进程，运行新的进程。否则新的进程等待。



### 7. 进程间通信有哪些方式？

![进程间通信方式](https://gitee.com/ljcdzh/my_pic/raw/master/img/202111252104103.webp)



## 参考

1. [操作系统常见面试题](https://juejin.cn/post/7014301927408140296#heading-1)
2. [计算机操作系统整理](https://juejin.cn/post/7017382237108699144)
3. [看完这篇操作系统，和面试官扯皮就没问题了](https://juejin.cn/post/6844904159402000392)
4. [操作系统面试重难点总结](https://juejin.cn/post/6844903478859431943)